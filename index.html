<!DOCTYPE html>
<html>
<head>

    <style>
        *{
            font-family: Arial, Helvetica, sans-serif;
        }
        body{
            background: radial-gradient(rgb(104,128,170),rgb(72,89,119));
            
        }

        .header{
            color: #fff;
            margin-bottom: 40px;
            border: 1px solid black;
        }
        .header h1,p{
            text-align: center;
        }

        #hamburger_menu{
            width: 3vw;
        }
        #logo{
            width: 20vw;
        }

        .wheel{
            display: flex;
            justify-content: center;
            position: relative;
        }
        .center-circle{
            width: 100px;
            height: 100px;
            border-radius: 60px;
            background-color:  rgb(104,128,170);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
        }
        .triangle{
            width: 0; 
            height: 0; 
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent; 
            border-right: 30px solid white; 
            position: absolute;
            top: 50%;
            right: -220%;
            transform: translateY(-50%);
        }
        textarea{
            background-color: rgba(20, 20, 20, 0.2);
            caret-color: #fff;
            resize: none;
            color: #fff;
        }
        .inputArea{
            display: flex;
            justify-content: center;
            margin-top: 40px;
        }
        .texto{
            background-color: rgba(48, 62, 84, 0.8);
        }
        .texto > p, .texto > h4, .texto > h3{
            margin: 10px;
            text-align: left;
            color: rgb(205, 205, 205);
            padding: 15px;
        }

        p{
            font-size: small;

        }

        a{
            color: rgb(0, 214, 214);
            text-decoration: none;
        }

        ul{
            text-decoration-color: white;
        }
        
    </style>

</head>

<body >

    <div class="header">
        <img src="menu.png" id="hamburger_menu" onclick="openMenu()">
        <img src="spinTheWheel-bg.png" id="logo">
    </div>
    <div class="wheel">
        <canvas class="" id="canvas" width="500" height="500"></canvas>
        <div class="center-circle" onclick="spin()">
            <div class="triangle"></div>
        </div>
        
    </div>
    <div class="inputArea" onchange="createWheel()">
        <textarea rows="20" cols="30" >cat
dog
cow
duck
sheep
goat
bird
neko
chicken</textarea>
    </div>

    <div class="texto">
        <p>Gira la rueda o <b>M칔LTIPLES</b> ruedas simult치neamente. Crea una rueda personalizada ahora usando esta herramienta gratuita de generaci칩n de decisiones aleatorias en l칤nea.<br/><br/>

            Spin the Wheel es una rueda giratoria para ayudarte a decidir al hacer una elecci칩n aleatoria. Si necesita una rueda de la suerte, una <a href="" href="">random generador de n칰meros</a>, una <a href="">rueda de nombres</a>, una <a href="">generador de sorteos</a> , una rueda de la fortuna para juegos o una simple <a href=""> rueda s칤 o no</a>, simplemente gira la rueda para obtener lo que necesitas.<br/><br/>
            
            Este simulador de rueda virtual es el primero de su tipo que te permite crear m칰ltiples ruedas giratorias dise침adas a medida para usarlas de forma independiente o al mismo tiempo. Esto abre una amplia gama de posibilidades.
        </p>
        <h3>C칩mo hacer y amp; Gira la rueda 游</h3>
        <p>
            Para lograr esto, crea una nueva rueda y ed칤tala agregando tus propias entradas. Utilice la funcionalidad 'Dise침o' para darle personalidad a su p치gina de la rueda y presione 'Guardar' para poder usarla nuevamente m치s tarde.<br/><br/>

            Puede usar la pesta침a 'Editar' para insertar im치genes, cualquier texto como nombres, n칰meros, porcentajes y emojis 游댠. Los profesores pueden girar la rueda para usarla como selector aleatorio de nombres para el aula combinado con una segunda rueda con una pregunta en particular.<br/><br/>

            Puedes girar una rueda para decidir entre ofertas de trabajo, qu칠 juego jugar o crear. un nombre aleatorio para un personaje de un libro que est치s escribiendo. Las posibilidades no terminan ah칤, ya que las ruedas aleatorias son definitivamente m치s interesantes cuando usas dos o m치s...
        </p>
        <h4>
            Funcionalidad de M칔LTIPLES Ruedas Giratorias
        </h4>

        <p>Lo que hace que Spin the Wheel se destaque de las singulares sitios web de ruedas es la capacidad de agregar y guardar hasta ocho ruedas en una p치gina.<br/><br/>

            Haga clic en 'Agregar' en el men칰 del panel de la rueda para crear varias ruedas. Utilice 'Editar' en el men칰 del panel para ajustar la configuraci칩n de cada rueda.<br/><br/>
            
            Digamos que desea utilizar una rueda giratoria para decidir qu칠 comer para la cena y una segunda rueda para decidir si comer dentro o fuera de la comida. En spinthewheel.io, puedes crearlos y luego girarlos simult치neamente para llegar a tu decisi칩n.<br/><br/>
            
            Otra forma de utilizar la funcionalidad de m칰ltiples ruedas es creando una rueda personalizada de nombres para elegir un persona, luego una segunda rueda para decidir qu칠 ganar치 esa persona (de una lista de premios) y luego una tercera rueda para decidir sobre un desaf칤o que la persona seleccionada por la primera rueda debe completar para ganar ese premio.<br/><br/>
            
            Las posibilidades de rueda personalizada son casi infinitas e incluso puedes dise침ar la rueda editable con una imagen de fondo e im치genes (im치genes) en cada rueda.<br/><br/>
            
            Adem치s, este creador de ruedas giratorias Se puede editar con audio personalizado eligiendo entre una selecci칩n de m칰sica y efectos de sonido. Este sistema generador de ruedas giratorias libres ha sido dise침ado teniendo en cuenta la m치xima flexibilidad.
        </p>
        <p>Ruedas populares</p>
        <ul>
            <li><a href="">Rodillo de dados <span>(2 dados)</span></a></li>
            <li><a href="">Lanza 2 monedas</a></li>
            <li><a href="">Prueba de Matem치ticas</a></li>
            <li><a href="">游녤<b>TODAS</b> Ruedas listas para usar</a></li>
        </ul>


    </div>
    <input type="checkbox" name="radio" id="radio">
    <script>
        function openMenu(){
            let menu = document.getElementById('menu')
        }

        function randomColor(){
            r = Math.floor(Math.random() * 255);
            g = Math.floor(Math.random() * 255);
            b = Math.floor(Math.random() * 255);
            return {r,g,b}
        }
        function toRad(deg){
            return deg * (Math.PI / 180.0);
        }
        function randomRange(min,max){
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        function easeOutSine(x) {
            return Math.sin((x * Math.PI) / 2);
        }
        // get percent between 2 number
        function getPercent(input,min,max){
            return (((input - min) * 100) / (max - min))/100
        }
    </script>

    <script>
        const canvas = document.getElementById("canvas")
        const ctx = canvas.getContext("2d")
        const width = document.getElementById("canvas").width
        const height = document.getElementById("canvas").height

        const centerX = width/2
        const centerY = height/2
        const radius = width/2

        var cont = 0
        var shiftsNumber = 1
        let items = document.getElementsByTagName("textarea")[0].value.split("\n");

        let currentDeg = 0
        let step = 360/items.length
        let colors = []
        let itemDegs = {}

        for(let i = 0 ; i < items.length + 1;i++){
            colors.push(randomColor())
        }

        function createWheel(){
            items = document.getElementsByTagName("textarea")[0].value.split("\n");
            step = 360/items.length
            colors = []
            for(let i = 0 ; i < items.length + 1;i++){
                colors.push(randomColor())
            }
            draw()
        }
        draw()
        let radioInput = document.getElementById('radio')
        function draw(){
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, toRad(0), toRad(360))
            ctx.fillStyle = `rgb(${33},${33},${33})`
            ctx.lineTo(centerX, centerY);
            ctx.fill()

            let startDeg = currentDeg;
            for(let i = 0 ; i < items.length; i++, startDeg += step){
                let endDeg = startDeg + step

                color = colors[i]
                let colorStyle = `rgb(${color.r},${color.g},${color.b})`

                ctx.beginPath();
                rad = toRad(360/step);
                ctx.arc(centerX, centerY, radius - 2, toRad(startDeg), toRad(endDeg))
                let colorStyle2 = `rgb(${color.r - 30},${color.g - 30},${color.b - 30})`
                ctx.fillStyle = colorStyle2
                ctx.lineTo(centerX, centerY);
                ctx.fill()

                ctx.beginPath();
                rad = toRad(360/step);
                ctx.arc(centerX, centerY, radius - 30, toRad(startDeg), toRad(endDeg))
                ctx.fillStyle = colorStyle
                ctx.lineTo(centerX, centerY);
                ctx.fill()

                // draw text
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(toRad((startDeg + endDeg)/2));
                ctx.textAlign = "center";
                if(color.r > 150 || color.g > 150 || color.b > 150){
                    ctx.fillStyle = "#000";
                }
                else{
                    ctx.fillStyle = "#fff";
                }
                ctx.font = 'bold 24px serif';
                ctx.fillText(items[i], 130, 10);
                ctx.restore();

                itemDegs[items[i]] = 
                    {
                    "startDeg": startDeg,
                    "endDeg" : endDeg
                    }
                

                // check winner
                if(startDeg%360 < 360 && startDeg%360 > 270  && endDeg % 360 > 0 && endDeg%360 < 90 ){
                    
                    
                    if (radioInput.checked){
                        let rondasWin = [1,3,5,7]
                        if (rondasWin.includes(shiftsNumber)){
                            if(cont != 0){
                                lastChance = items[i]
                            } 
                        }else {
                            lastChance = "aleatory"
                        }
                        
                    }
                    
                }
            }
        }
        
        let tramps = {
            "Christian": "Clara",
            "Clara": "Christian",
            "Lorena": "Marcos",
            "Marcos": "Lorena",
            "Peque침in": "Bizum",
            "Chonija": "Traumas",
            "Bizum": "Peque침in",
            "Traumas": "Chonija"
        }

        let lastChance = ""
        let speed = 0
        let maxRotation = randomRange(360* 3, 360 * 6)
        let pause = false
        function animate(){
            if(pause){
                return
            }
            speed = easeOutSine(getPercent(currentDeg ,maxRotation ,0)) * 20
            if(speed < 0.01){
                speed = 0
                pause = true
            }
            currentDeg += speed
            draw()
            window.requestAnimationFrame(animate);
        }
        
        
        
        function spin(){
            let rondasWin = [1,3,5,7]

            if(speed != 0){
                return
            }

            maxRotation = 0;
            currentDeg = 0
            createWheel()
            draw();
            
            // En caso de activar el checkbox. Solo hay 1 y 2 oportunidad por que somos 4 personas. 
            // Si somos 4 personas entonces solo va a ver 2 turnos. 1 para sacar a la primera persona y otro para sacar a quien la acompa침a. La otra pareja se saca por descarte
            if(lastChance == ""){
                //Primera oportunidad o que el checkbox no esta activo
                let random = Math.floor(Math.random() * 4);
                let randomGrades = Math.floor(Math.random() * 89);
                maxRotation = (360 * 6) - itemDegs[items[random]].endDeg + randomGrades
                cont++
                
            }else if (lastChance == "aleatory"){
                let randomGrades = Math.floor(Math.random() * 89);
                if(cont == 0){
                    let random = Math.floor(Math.random() * 2);
                    let equipo2 = ['Clara', 'Christian']
                    maxRotation = (360 * 6) - itemDegs[equipo2[random]].endDeg + randomGrades
                }else{
                    let random = Math.floor(Math.random() * 2);
                    let equipo1 = ['Lorena', 'Marcos']
                    maxRotation = (360 * 6) - itemDegs[equipo1[random]].endDeg + randomGrades

                }
                cont++
                

            }else{
                //Segunda oportunidad
                personaTrucada = tramps[lastChance]
                debugger;
                maxRotation = (360 * 6) - itemDegs[personaTrucada].endDeg + 30
                lastChance = ""
                personaTrucada = ""
                debugger;
                cont = 2
            }

            if(cont == 2){
                shiftsNumber++
                cont = 0
                lastChance = "" 
            }
            
            itemDegs = {}
            console.log("max",maxRotation)
            console.log(itemDegs);
            pause = false
            window.requestAnimationFrame(animate);
        }
        

    </script>
</body>

</html>
